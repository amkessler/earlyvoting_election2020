---
title: "Demographics and Party Breakdowns"
author: "Aaron Kessler"
date: "10/25/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(janitor)
library(lubridate)
library(readxl)
library(writexl)
library(tidycensus)
options(scipen = 999)

#load saved file with key prez states only
state_keyprezonly_bothcycles <- readRDS("processed_data/state_keyprezonly_bothcycles.rds")

```

## Gender

Growth from previous cycle

```{r pressure, echo=FALSE}

#growth from last cycle
gender_states <- 
  
state_keyprezonly_bothcycles %>% 
  group_by(cycle, state, gender) %>% 
  summarise(
    total_returned = sum(ballots_returned, na.rm = TRUE)
  ) %>% 
  pivot_wider(names_from = c(cycle, gender), values_from = total_returned) %>% 
  mutate(
    diff_female = total_returned_2020 - total_returned_2016,
    pctchg_female = round_half_up((total_returned_2020 - total_returned_2016) / total_returned_2016 * 100, 2)
  ) 

gender_states %>% 
  select(state, gender, pctchg_requested, pctchg_returned)

```

